<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Oakheart Prototype</title>
<style>
body { font-family: Arial; background: linear-gradient(to right,#6a11cb,#2575fc); color:white; margin:0; text-align:center; }
section { background: rgba(255,255,255,0.1); border-radius:10px; margin:20px auto; padding:20px; width:90%; max-width:700px; }
textarea, input, select { width:100%; padding:10px; border-radius:8px; border:none; margin:10px 0; }
button { background:#ffcc00; color:black; border:none; padding:10px 20px; border-radius:8px; font-weight:bold; cursor:pointer; margin:5px; }
button:hover { background:#ffaa00; }
#chatbox { background:white; color:black; padding:10px; border-radius:8px; height:200px; overflow-y:auto; text-align:left; }
.journal-entry,.community-entry { background: rgba(0,0,0,0.2); padding:8px; margin:5px 0; border-radius:6px; text-align:left; }
.badge { display:inline-block; background:#ffcc00; color:black; padding:5px 10px; margin:3px; border-radius:6px; font-weight:bold; }
</style>
</head>
<body>
<header>üå≥ Oakheart</header>

<main>
<section>
<h2>ü§ñ AI MoodBot</h2>
<div id="chatbox">Hello! I‚Äôm your AI MoodBot.</div>
<input type="text" id="userInput" placeholder="Type your message..."/>
<button onclick="sendMessage()">Send</button>
</section>

<section>
<h2>üìä Health Tracker</h2>
<select id="mood"><option value="">Select Mood</option><option>Happy</option><option>Sad</option><option>Stressed</option><option>Anxious</option></select>
<input type="number" id="sleep" placeholder="Hours slept" min="0" max="24"/>
<input type="number" id="activity" placeholder="Exercise minutes" min="0" max="300"/>
<button onclick="saveHealthData()">Save Health Data</button>
<p id="healthStatus"></p>
</section>

<section>
<h2>üìù Journal</h2>
<textarea id="journal" rows="5" placeholder="Write thoughts..."></textarea>
<button onclick="saveJournal()">Save Journal</button>
<p id="journalStatus"></p>
<button onclick="fetchEntries()">Load Entries</button>
<div id="entries"></div>
</section>

<section>
<h2>üåê Community Feed</h2>
<textarea id="communityPost" rows="2" placeholder="Share a thought..."></textarea>
<button onclick="postCommunity()">Post</button>
<div id="communityFeed"></div>
</section>

<section>
<h2>üèÜ Streaks & Badges</h2>
<div id="streakDisplay">Current Streak: 0 days</div>
<div id="badgesDisplay"></div>
</section>
</main>

<script>
const BACKEND_URL="YOUR_RENDER_BACKEND_URL_HERE"; // Replace with your Render backend URL

// -------- AI Chatbot --------
async function sendMessage(){
const input=document.getElementById("userInput").value;
if(!input.trim())return;
const chatbox=document.getElementById("chatbox");
chatbox.innerHTML+=`<div><b>You:</b> ${input}</div>`;
chatbox.scrollTop=chatbox.scrollHeight;
document.getElementById("userInput").value="";
try{
const res=await fetch(`${BACKEND_URL}/api/chat`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:input})});
const data=await res.json();
chatbox.innerHTML+=`<div><b>MoodBot:</b> ${data.reply}</div>`;
chatbox.scrollTop=chatbox.scrollHeight;
}catch(err){chatbox.innerHTML+=`<div><b>MoodBot:</b> ‚ùå Failed to get response.</div>`;}
}

// -------- Health Data --------
async function saveHealthData(){
const mood=document.getElementById("mood").value;
const sleep=document.getElementById("sleep").value;
const activity=document.getElementById("activity").value;
if(!mood||!sleep||!activity){document.getElementById("healthStatus").textContent="‚ö†Ô∏è Fill all fields.";return;}
try{
await fetch(`${BACKEND_URL}/api/health`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({mood,sleep,activity})});
let streak=parseInt(localStorage.getItem("streak")||"0")+1;
localStorage.setItem("streak",streak);
let badges=JSON.parse(localStorage.getItem("badges")||"[]");
if(streak%3===0&&!badges.includes("Consistency"))badges.push("Consistency");
if(parseInt(sleep)>=7&&!badges.includes("Healthy Sleep"))badges.push("Healthy Sleep");
if(parseInt(activity)>=30&&!badges.includes("Active"))badges.push("Active");
localStorage.setItem("badges",JSON.stringify(badges));
updateStreakAndBadges();
document.getElementById("healthStatus").textContent="‚úÖ Health data saved!";
document.getElementById("mood").value="";
document.getElementById("sleep").value="";
document.getElementById("activity").value="";
}catch(err){document.getElementById("healthStatus").textContent="‚ùå Failed to save.";}
}

function updateStreakAndBadges(){
document.getElementById("streakDisplay").textContent=`Current Streak: ${localStorage.getItem("streak")||0} days`;
const badges=JSON.parse(localStorage.getItem("badges")||"[]");
const badgesDiv=document.getElementById("badgesDisplay");
badgesDiv.innerHTML="";
badges.forEach(b=>{badgesDiv.innerHTML+=`<span class="badge">${b}</span>`;});
}

// -------- Journal --------
async function saveJournal(){
const text=document.getElementById("journal").value;
if(!text.trim())return;
try{
const res=await fetch(`${BACKEND_URL}/api/journal`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text})});
const data=await res.json();
document.getElementById("journalStatus").textContent="‚úÖ "+data.message;
document.getElementById("journal").value="";
}catch(err){document.getElementById("journalStatus").textContent="‚ùå Failed.";}
}

async function fetchEntries(){
try{
const res=await fetch(`${BACKEND_URL}/api/journal`);
const data=await res.json();
const entriesDiv=document.getElementById("entries");
entriesDiv.innerHTML="";
if(data.length===0)entriesDiv.innerHTML="<p>No entries yet.</p>";
data.forEach(entry=>{
entriesDiv.innerHTML+=`<div class="journal-entry">${new Date(entry.date).toLocaleString()} - ${entry.text}</div>`;
});
}catch(err){document.getElementById("entries").innerHTML="‚ùå Failed to load entries.";}
}

// -------- Community --------
async function postCommunity(){
const text=document.getElementById("communityPost").value;
if(!text.trim())return;
try{
await fetch(`${BACKEND_URL}/api/community`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text})});
document.getElementById("communityPost").value="";
fetchCommunity();
}catch(err){alert("‚ùå Failed to post.");}
}

async function fetchCommunity(){
try{
const res=await fetch(`${BACKEND_URL}/api/community`);
const posts=await res.json();
const feedDiv=document.getElementById("communityFeed");
feedDiv.innerHTML="";
posts.forEach(p=>{
feedDiv.innerHTML+=`<div class="community-entry">${new Date(p.date).toLocaleString()} - ${p.text}</div>`;
});
}catch(err){document.getElementById("communityFeed").innerHTML="‚ùå Failed to load posts.";}
}

// Initialize
updateStreakAndBadges();
fetchCommunity();
</script>
</body>
</html>

